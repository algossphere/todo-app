#----fork from TLarsh and made contributions
